(()=>{"use strict";var e={810:(e,t,n)=>{n.d(t,{Z:()=>i});var r=n(645),a=n.n(r)()((function(e){return e[1]}));a.push([e.id,".car__item {\n    border-bottom: 5px dashed black;\n    position: relative;\n    height: 55px;\n}\n\n.car__carImg {\n    height: 85px;\n    position: absolute;\n}\n\n.car__flagImg {\n    height: 60px;\n    position: absolute;\n    right: 100px;\n}\n\nbutton {\n    position: relative;\n    z-index: 1;\n}\n",""]);const i=a},462:(e,t,n)=>{n.d(t,{Z:()=>i});var r=n(645),a=n.n(r)()((function(e){return e[1]}));a.push([e.id,".winners__cars {\n    display: flex;\n    justify-content: space-between;\n    width: 450px;\n}\n\n.winners__cars > div {\n    width: 80px;\n    padding-left: 3px;\n}\n\n.winners__svg {\n    height: 40px;\n    position: relative;\n    top: -30px\n}",""]);const i=a},751:(e,t,n)=>{n.d(t,{Z:()=>i});var r=n(645),a=n.n(r)()((function(e){return e[1]}));a.push([e.id,".garage__winner {\n    position: absolute;\n    top: 50px;\n    left: 310px;\n    color: red;\n    font-size: 35px;\n}",""]);const i=a},29:(e,t,n)=>{n.d(t,{Z:()=>i});var r=n(645),a=n.n(r)()((function(e){return e[1]}));a.push([e.id,".winners__nameTable {\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    background: blue;\n    color: white;\n    height: 50px;\n    font-size: 20px;\n    width: 450px;\n    padding: 0 5px;\n}\n\n.winners__nameTable  > div {\n    width: 80px;\n}\n\n.winners__wins {\n    cursor: pointer;\n}\n\n.winners__time {\n    cursor: pointer;\n}\n",""]);const i=a},426:(e,t,n)=>{n.d(t,{Z:()=>i});var r=n(645),a=n.n(r)()((function(e){return e[1]}));a.push([e.id,"button{\n    cursor: pointer;\n    margin: 3px 0;\n}",""]);const i=a},645:e=>{e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var n=e(t);return t[2]?"@media ".concat(t[2]," {").concat(n,"}"):n})).join("")},t.i=function(e,n,r){"string"==typeof e&&(e=[[null,e,""]]);var a={};if(r)for(var i=0;i<this.length;i++){var s=this[i][0];null!=s&&(a[s]=!0)}for(var o=0;o<e.length;o++){var c=[].concat(e[o]);r&&a[c[0]]||(n&&(c[2]?c[2]="".concat(n," and ").concat(c[2]):c[2]=n),t.push(c))}},t}},379:(e,t,n)=>{var r,a=function(){var e={};return function(t){if(void 0===e[t]){var n=document.querySelector(t);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(e){n=null}e[t]=n}return e[t]}}(),i=[];function s(e){for(var t=-1,n=0;n<i.length;n++)if(i[n].identifier===e){t=n;break}return t}function o(e,t){for(var n={},r=[],a=0;a<e.length;a++){var o=e[a],c=t.base?o[0]+t.base:o[0],d=n[c]||0,l="".concat(c," ").concat(d);n[c]=d+1;var u=s(l),h={css:o[1],media:o[2],sourceMap:o[3]};-1!==u?(i[u].references++,i[u].updater(h)):i.push({identifier:l,updater:m(h,t),references:1}),r.push(l)}return r}function c(e){var t=document.createElement("style"),r=e.attributes||{};if(void 0===r.nonce){var i=n.nc;i&&(r.nonce=i)}if(Object.keys(r).forEach((function(e){t.setAttribute(e,r[e])})),"function"==typeof e.insert)e.insert(t);else{var s=a(e.insert||"head");if(!s)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");s.appendChild(t)}return t}var d,l=(d=[],function(e,t){return d[e]=t,d.filter(Boolean).join("\n")});function u(e,t,n,r){var a=n?"":r.media?"@media ".concat(r.media," {").concat(r.css,"}"):r.css;if(e.styleSheet)e.styleSheet.cssText=l(t,a);else{var i=document.createTextNode(a),s=e.childNodes;s[t]&&e.removeChild(s[t]),s.length?e.insertBefore(i,s[t]):e.appendChild(i)}}function h(e,t,n){var r=n.css,a=n.media,i=n.sourceMap;if(a?e.setAttribute("media",a):e.removeAttribute("media"),i&&"undefined"!=typeof btoa&&(r+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(i))))," */")),e.styleSheet)e.styleSheet.cssText=r;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(r))}}var g=null,p=0;function m(e,t){var n,r,a;if(t.singleton){var i=p++;n=g||(g=c(t)),r=u.bind(null,n,i,!1),a=u.bind(null,n,i,!0)}else n=c(t),r=h.bind(null,n,t),a=function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(n)};return r(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap)return;r(e=t)}else a()}}e.exports=function(e,t){(t=t||{}).singleton||"boolean"==typeof t.singleton||(t.singleton=(void 0===r&&(r=Boolean(window&&document&&document.all&&!window.atob)),r));var n=o(e=e||[],t);return function(e){if(e=e||[],"[object Array]"===Object.prototype.toString.call(e)){for(var r=0;r<n.length;r++){var a=s(n[r]);i[a].references--}for(var c=o(e,t),d=0;d<n.length;d++){var l=s(n[d]);0===i[l].references&&(i[l].updater(),i.splice(l,1))}n=c}}}}},t={};function n(r){var a=t[r];if(void 0!==a)return a.exports;var i=t[r]={id:r,exports:{}};return e[r](i,i.exports,n),i.exports}n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.p="./",n.nc=void 0,(()=>{var e=n(379),t=n.n(e),r=n(426);t()(r.Z,{insert:"head",singleton:!1}),r.Z.locals;const a="https://async-race-api-fq8d.onrender.com";class i extends Error{constructor(e){super(e),this.name="DuplicateError"}}class s extends Error{constructor(e){super(e),this.name="EngineError"}}class o{constructor(e,t,n){this.garage=e,this.service=t,this.winnerService=n,this.page=1,this.сarsEngine=[]}async render(){const e=await this.service.getCars(this.page);this.garage.render(e.cars,e.count,this.page),this.setCarsEngine(e.cars)}async getCars(){return(await this.service.getCars(this.page)).cars}async updateGarage(){const e=await this.service.getCars(this.page);this.garage.clear(),this.garage.renderCars(e.cars),this.garage.updateTitle(e.count,this.page),this.setCarsEngine(e.cars)}setCarsEngine(e){this.сarsEngine=e.map((e=>({id:e.id,state:"stop",name:e.name})))}async addCar(e){await this.service.addCar(e),this.updateGarage()}async deleteCar(e){await this.service.deleteCar(e),this.updateGarage()}async getCar(e){return await this.service.getCar(e)}async updateCar(e,t){await this.service.updateCar(e,t),this.updateGarage()}async generateCars(e){e.forEach((e=>this.service.addCar(e))),this.updateGarage()}async setPrevPage(){this.page>1&&(this.page--,this.updateGarage())}async setNextPage(){const e=await this.service.getCars(this.page);this.page<e.count/7&&(this.page++,this.updateGarage())}async startCar(e){const t=await this.service.startCar(e),n=this.сarsEngine.find((t=>t.id===e));return n&&(n.state="start",n.time=(t.distance/t.velocity/1e3).toFixed(2)),t}async stopCar(e){await this.service.stopCar(e);const t=this.сarsEngine.find((t=>t.id===e));t&&(t.state="stop")}getEngineState(e){return this.сarsEngine.find((t=>t.id===e))?.state}async driveCar(e){const t=this.сarsEngine.find((t=>t.id===e));try{return await this.service.driveCar(e),t}catch(t){if(t instanceof s){const t=this.сarsEngine.find((t=>t.id===e));t&&(t.state="break")}throw t}}clearPage(){this.garage.clearPage()}async addWinnerCar(e){try{await this.winnerService.addWinner(e)}catch(t){if(!(t instanceof i))throw t;{const t=await this.getWinner(e.id),n=e.time<t.time?e.time:t.time;this.updateWinner(e.id,{wins:t.wins+1,time:n})}}}async getWinner(e){return await this.winnerService.getWinner(e)}async updateWinner(e,t){return await this.winnerService.updateWinner(e,t)}async deleteWinner(e){await this.winnerService.deleteWinner(e)}init(){this.garage.bindAddCar(this.addCar.bind(this)),this.garage.bindDeleteCar(this.deleteCar.bind(this),this.deleteWinner.bind(this)),this.garage.bindGetCar(this.getCar.bind(this)),this.garage.bindUpdateCar(this.updateCar.bind(this)),this.garage.bindGenerateCars(this.generateCars.bind(this)),this.garage.bindSetPrevPage(this.setPrevPage.bind(this)),this.garage.bindSetNextPage(this.setNextPage.bind(this)),this.garage.bindStartCar(this.startCar.bind(this),this.driveCar.bind(this),this.getEngineState.bind(this)),this.garage.bindStopCar(this.stopCar.bind(this)),this.garage.bindStartAllCars(this.getCars.bind(this),this.startCar.bind(this),this.driveCar.bind(this),this.getEngineState.bind(this),this.addWinnerCar.bind(this)),this.garage.bindReset(this.getCars.bind(this))}}var c=n(751);t()(c.Z,{insert:"head",singleton:!1}),c.Z.locals;const d=["BMW","Audi","Ford","Honda","Hyundai","Kia","Mazda","Mercedes","Mitsubishi","Nissan"];var l=n(810);t()(l.Z,{insert:"head",singleton:!1}),l.Z.locals;const u=n.p+"38c75c74682a6f31b40d.png";function h(e){return`<svg fill="${e}" height="85px" viewBox="0 -43.92 122.88 122.88" style="position: absolute" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xml:space="preserve" transform="matrix(-1, 0, 0, 1, 0, 0)">\n    <g id="SVGRepo_bgCarrier" stroke-width="0"/>\n    <g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"/>\n    <g id="SVGRepo_iconCarrier"> <style type="text/css">.st0{fill-rule:evenodd;clip-rule:evenodd;}</style> <g> <path class="st0" d="M99.42,13.57c5.93,0,10.73,4.8,10.73,10.73c0,5.93-4.8,10.73-10.73,10.73s-10.73-4.8-10.73-10.73 C88.69,18.37,93.49,13.57,99.42,13.57L99.42,13.57z M79.05,5c-0.59,1.27-1.06,2.69-1.42,4.23c-0.82,2.57,0.39,3.11,3.19,2.06 c2.06-1.23,4.12-2.47,6.18-3.7c1.05-0.74,1.55-1.47,1.38-2.19c-0.34-1.42-3.08-2.16-5.33-2.6C80.19,2.23,80.39,2.11,79.05,5 L79.05,5z M23.86,19.31c2.75,0,4.99,2.23,4.99,4.99c0,2.75-2.23,4.99-4.99,4.99c-2.75,0-4.99-2.23-4.99-4.99 C18.87,21.54,21.1,19.31,23.86,19.31L23.86,19.31z M99.42,19.31c2.75,0,4.99,2.23,4.99,4.99c0,2.75-2.23,4.99-4.99,4.99 c-2.75,0-4.99-2.23-4.99-4.99C94.43,21.54,96.66,19.31,99.42,19.31L99.42,19.31z M46.14,12.5c2.77-2.97,5.97-4.9,9.67-6.76 c8.1-4.08,13.06-3.58,21.66-3.58l-2.89,7.5c-1.21,1.6-2.58,2.73-4.66,2.84H46.14L46.14,12.5z M23.86,13.57 c5.93,0,10.73,4.8,10.73,10.73c0,5.93-4.8,10.73-10.73,10.73s-10.73-4.8-10.73-10.73C13.13,18.37,17.93,13.57,23.86,13.57 L23.86,13.57z M40.82,10.3c3.52-2.19,7.35-4.15,11.59-5.82c12.91-5.09,22.78-6,36.32-1.9c4.08,1.55,8.16,3.1,12.24,4.06 c4.03,0.96,21.48,1.88,21.91,4.81l-4.31,5.15c1.57,1.36,2.85,3.03,3.32,5.64c-0.13,1.61-0.57,2.96-1.33,4.04 c-1.29,1.85-5.07,3.76-7.11,2.67c-0.65-0.35-1.02-1.05-1.01-2.24c0.06-23.9-28.79-21.18-26.62,2.82H35.48 C44.8,5.49,5.04,5.4,12.1,28.7C9.62,31.38,3.77,27.34,0,18.75c1.03-1.02,2.16-1.99,3.42-2.89c-0.06-0.05,0.06,0.19-0.15-0.17 c-0.21-0.36,0.51-1.87,1.99-2.74C13.02,8.4,31.73,8.52,40.82,10.3L40.82,10.3z"/> </g> </g>\n    </svg>`}class g{static render(e){const t=document.createElement("div");return t.className="car__in__garage",t.setAttribute("data-id",e.id.toString()),t.innerHTML=`\n            <div>\n                <button class="select__car">SELECT</button>\n                <button class="remove__car">REMOVE</button>\n                <span>${e.name}</span>\n            </div>\n            <div class="car__item">\n                <button class="start__car">A</button>\n                <button class="stop__car">B</button>\n                    ${h(e.color)}\n                <img src="${u}" alt="flag" class="car__flagImg">\n            </div>`,t}}function p(e,t){return e=Math.ceil(e),t=Math.floor(t),Math.floor(Math.random()*(t-e+1))+e}class m{constructor(e){this.selector=e}render(e,t,n){const r=document.querySelector(this.selector),a=document.createElement("div"),i=document.createElement("div");a.className="garage__page",i.className="garage";const s=this.getControl();a.appendChild(s);const o=this.getTitle(t,n);a.appendChild(o),a.appendChild(i);const c=this.getPagination();a.appendChild(c);const d=this.getWinner();a.appendChild(d),r.appendChild(a),this.renderCars(e)}renderCars(e){const t=document.querySelector(".garage");e.forEach((e=>{const n=g.render(e);t.appendChild(n)}))}updateTitle(e,t){const n=document.querySelector(".garage__title__count"),r=document.querySelector(".garage__title__page");n.innerHTML=e.toString(),r.innerHTML=t.toString()}getControl(){const e=document.createElement("div");return e.innerHTML='<div class="create">\n        <input type="text">\n        <input type="color">\n        <button>CREATE</button>\n    </div>\n    <div class ="update">\n        <input type="text">\n        <input type="color">\n        <button>UPDATE</button>\n    </div>\n    <div>\n        <button class="race">RACE</button>\n        <button class="reset">RESET</button>\n        <button class="generate__cars">GENERATE CARS</button>\n    </div>',e}getTitle(e,t){const n=document.createElement("div");return n.innerHTML=`\n      <h3>Garage <span class="garage__title__count">${e}</span></h3>\n      <span>Page #<span class="garage__title__page">${t}</span></span>`,n}getPagination(){const e=document.createElement("div");return e.innerHTML='\n      <button class="garage__prev">PREV</button>\n      <button class="garage__next">NEXT</button>',e}getWinner(){const e=document.createElement("div");return e.className="garage__winner",e}setWinner(e){document.querySelector(".garage__winner").innerHTML=`${e.name} wont first [${e.time}s]!`}getCarId(e){const t=e.closest(".car__in__garage");return Number(t.getAttribute("data-id"))}async moveCar(e,t,n){const r=await t(e),a=document.querySelector(`div[data-id="${e}"]`).querySelector("svg");let i=a.getBoundingClientRect().left+window.scrollX;const s=(window.innerWidth-i-120)/(r.distance/r.velocity)*(1e3/60);!function t(){const r=n(e);"start"===r&&i<window.innerWidth-120?window.requestAnimationFrame((()=>{i+=s,a.style.left=i.toString(),t()})):"stop"===r&&(a.style.left="")}()}stopCar(e){document.querySelector(`div[data-id="${e}"]`).querySelector("svg").style.left=""}bindAddCar(e){document.querySelector(".create > button").addEventListener("click",(()=>{const t=document.querySelector('.create > input[type="text"]');if(t.value){const n=document.querySelector('.create > input[type="color"]'),r={name:t.value,color:n.value};e(r),t.value="",n.value="#000000"}}))}bindDeleteCar(e,t){document.querySelector(".garage").addEventListener("click",(async n=>{const r=n.target;if("remove__car"===r.className){const n=this.getCarId(r);await e(n),t(n)}}))}bindGetCar(e){document.querySelector(".garage").addEventListener("click",(async t=>{const n=t.target;if("select__car"===n.className){const t=this.getCarId(n),r=await e(t),a=document.querySelector(".update"),i=a.querySelector('input[type="text"]'),s=a.querySelector('input[type="color"]');a.setAttribute("data-id",t.toString()),i.value=r.name,s.value=r.color}}))}bindUpdateCar(e){document.querySelector(".update > button").addEventListener("click",(()=>{const t=document.querySelector('.update > input[type="text"]');if(t.value){const n=document.querySelector(".update"),r=n.querySelector('input[type="color"]'),a=Number(n.getAttribute("data-id")),i={name:t.value,color:r.value};e(a,i),t.value="",r.value="#000000"}}))}bindGenerateCars(e){document.querySelector(".generate__cars").addEventListener("click",(()=>{const t=[];for(let e=0;e<100;e++){const e={name:d[p(0,d.length-1)],color:"#"+p(0,999999)};t.push(e)}e(t)}))}bindSetPrevPage(e){document.querySelector(".garage__prev").addEventListener("click",(()=>{e()}))}bindSetNextPage(e){document.querySelector(".garage__next").addEventListener("click",(()=>{e()}))}bindStartCar(e,t,n){document.querySelector(".garage").addEventListener("click",(async r=>{const a=r.target;if("start__car"===a.className){const r=this.getCarId(a);await this.moveCar(r,e,n),t(r),a.disabled=!0}}))}bindStopCar(e){document.querySelector(".garage").addEventListener("click",(async t=>{const n=t.target;if("stop__car"===n.className){const t=this.getCarId(n);await e(t),this.stopCar(t),n.previousElementSibling.disabled=!1}}))}bindStartAllCars(e,t,n,r,a){const i=document.querySelector(".race");i.addEventListener("click",(async()=>{const s=await e(),o=s.map((e=>this.moveCar(e.id,t,r)));await Promise.allSettled(o);const c=s.map((e=>n(e.id)));i.disabled=!0;const d=document.querySelector(".reset");d.disabled=!0,document.querySelectorAll(".start__car").forEach((e=>e.disabled=!0)),Promise.any(c).then((e=>{this.setWinner(e),a({id:e.id,wins:1,time:e.time})})).catch((()=>console.log("Все машины сломались"))),await Promise.allSettled(c),d.disabled=!1}))}bindReset(e){document.querySelector(".reset").addEventListener("click",(async()=>{(await e()).forEach((e=>this.stopCar(e.id))),document.querySelector(".garage__winner").innerHTML="",document.querySelector(".race").disabled=!1,document.querySelectorAll(".start__car").forEach((e=>e.disabled=!1))}))}clear(){document.querySelector(".garage").innerHTML=""}clearPage(){document.querySelector(".garage__page").remove()}}var v,w,b;!function(e){e.Garage="garage",e.Winners="winners"}(v||(v={})),function(e){e.Id="id",e.Wins="wins",e.Time="time"}(w||(w={})),function(e){e.ASC="ASC",e.DESC="DESC"}(b||(b={}));class C{constructor(e,t,n){this.winners=e,this.service=t,this.garageService=n,this.page=1,this.sort=w.Id,this.order=b.DESC}async render(){const e=await this.getWinnersWithNameAndColor();this.winners.render(e.count,this.page,e.winners)}async getWinnersWithNameAndColor(){const e=[],t=await this.getWinners(),n=t.winners;for(let t=0;n.length>t;t++){const r=await this.getCar(n[t].id),a={id:n[t].id,time:n[t].time,wins:n[t].wins,name:r.name,color:r.color};e.push(a)}return{count:t.count,winners:e}}async getWinners(){return await this.service.getWinners(this.page,this.sort,this.order)}async getCar(e){return await this.garageService.getCar(e)}async sortWinners(e){this.sort=e,this.order=this.order===b.ASC?b.DESC:b.ASC,await this.updateWinnersTable()}async updateWinnersTable(){this.winners.clearWinnersTable();const e=await this.getWinnersWithNameAndColor();this.winners.getTable(e.winners,this.page)}async setPrevPage(){this.page>1&&(this.page--,await this.updateWinnersTable())}async setNextPage(){const e=await this.getWinners();this.page<e.count/10&&(this.page++,await this.updateWinnersTable())}clearPage(){this.winners.clearPage()}init(){this.winners.bindSortWins(this.sortWinners.bind(this)),this.winners.bindSetPrevPage(this.setPrevPage.bind(this)),this.winners.bindSetNextPage(this.setNextPage.bind(this))}}var y=n(462);t()(y.Z,{insert:"head",singleton:!1}),y.Z.locals;class _{render(e,t){const n=document.createElement("div");return n.className="winners__cars",n.innerHTML=`\n            <div>${t}</div>\n            <div class="winners__svg">${h(e.color)}</div>\n            <div>${e.name}</div>\n            <div>${e.wins}</div>\n            <div>${e.time}</div>`,n}}var f=n(29);t()(f.Z,{insert:"head",singleton:!1}),f.Z.locals;class S{constructor(e){this.selector=e,this.winnerCar=new _}render(e,t,n){const r=document.querySelector(this.selector),a=document.createElement("div"),i=document.createElement("div");i.className="winners__table",a.className="winners__page";const s=this.getTitle(e,t);a.appendChild(s),a.appendChild(i);const o=this.getPagination();a.appendChild(o),r.appendChild(a),this.getTable(n,t)}getTitle(e,t){const n=document.createElement("div");return n.innerHTML=`\n      <h3>Winners <span class="winners__count">${e}</span></h3>\n      <span>Page #<span class="winners__page">${t}</span></span>\n      <div class="winners__nameTable">\n      <div>Number</div>\n      <div>Car</div>\n      <div>Name</div>\n      <div class="winners__wins">Wins</div>\n      <div class="winners__time">Best time (seconds)</div>\n      </div>`,n}getTable(e,t){const n=document.querySelector(".winners__table");e.forEach(((e,r)=>{const a=this.winnerCar.render(e,10*(t-1)+r+1);n.appendChild(a)}))}getPagination(){const e=document.createElement("div");return e.innerHTML='\n      <button class="winners__prev">PREV</button>\n      <button class="winners__next">NEXT</button>',e}bindSortWins(e){document.querySelector(".winners__nameTable").addEventListener("click",(async t=>{const n=t.target;"winners__wins"===n.className?e("wins"):"winners__time"===n.className&&e("time")}))}bindSetPrevPage(e){document.querySelector(".winners__prev").addEventListener("click",(()=>{e()}))}bindSetNextPage(e){document.querySelector(".winners__next").addEventListener("click",(()=>{e()}))}clearWinnersTable(){document.querySelector(".winners__table").innerHTML=""}clearPage(){document.querySelector(".winners__page").remove()}}class E{async getCars(e=1){const t=await fetch(`${a}/garage/?_page=${e}&_limit=7`,{method:"GET"});return{cars:await t.json(),count:Number(t.headers.get("X-Total-Count"))}}async addCar(e){return(await fetch(`${a}/garage`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})).json()}async deleteCar(e){return(await fetch(`${a}/garage/${e}`,{method:"DELETE"})).json()}async getCar(e){return(await fetch(`${a}/garage/${e}`,{method:"GET"})).json()}async updateCar(e,t){return(await fetch(`${a}/garage/${e}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)})).json()}async startCar(e){return(await fetch(`${a}/engine/?id=${e}&status=started`,{method:"PATCH"})).json()}async stopCar(e){return(await fetch(`${a}/engine/?id=${e}&status=stopped`,{method:"PATCH"})).json()}async driveCar(e){const t=await fetch(`${a}/engine/?id=${e}&status=drive`,{method:"PATCH"});if(400===t.status||404===t.status||429===t.status||500===t.status)throw new s(`${t.statusText} ${t.url}`);return t.json()}}class T{async getWinners(e,t,n){const r=await fetch(`${a}/winners/?_page=${e}&_limit=10&_sort=${t}&_order=${n}`,{method:"GET"});return{winners:await r.json(),count:Number(r.headers.get("X-Total-Count"))}}async addWinner(e){const t=await fetch(`${a}/winners`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(500===t.status)throw new i(`${t.statusText} ${t.url}`);return t.json()}async updateWinner(e,t){return(await fetch(`${a}/winners/${e}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)})).json()}async getWinner(e){return(await fetch(`${a}/winners/${e}`,{method:"GET"})).json()}async deleteWinner(e){return await fetch(`${a}/winners/${e}`,{method:"DELETE"})}}class x{constructor(e){this.garageController=new o(new m(e),new E,new T),this.winnersController=new C(new S(e),new T,new E),this.page=v.Garage}async render(){this.page===v.Garage?(await this.garageController.render(),this.garageController.init()):this.page===v.Winners&&(await this.winnersController.render(),this.winnersController.init())}toGarage(){this.page=v.Garage,this.winnersController.clearPage(),this.render()}toWinners(){this.page=v.Winners,this.garageController.clearPage(),this.render()}}class W{constructor(e,t){this.header=e,this.router=t}render(){this.header.render()}headerInit(){this.header.bindToGarage(this.router.toGarage.bind(this.router)),this.header.bindToWinners(this.router.toWinners.bind(this.router))}}class P{constructor(e){this.selector=e}render(){const e=document.querySelector(this.selector),t=document.createElement("div");t.innerHTML='<button class="to__garage">TO GARAGE</button> <button class="to__winners">TO WINNERS</button>',e.appendChild(t)}bindToGarage(e){document.querySelector(".to__garage").addEventListener("click",(()=>{e()}))}bindToWinners(e){document.querySelector(".to__winners").addEventListener("click",(()=>{e()}))}}new class{constructor(e){this.router=new x(e),this.headerController=new W(new P(e),this.router)}run(){this.headerController.render(),this.headerController.headerInit(),this.router.render()}}("#root").run()})()})();